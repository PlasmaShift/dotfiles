smartcd export 1.0
@ scripts/home/frew/code/plugins/bash_enter
 autostash DBIC_TRACE=1
 autostash WM_DEBUG=1
 autostash CATALYST_DEBUG=1
 autostash LYNX_DSN_PATH=/home/frew/code/flu-db.txt
 autostash PERL5LIB=__PATH__/../lynx/App/lib:__PATH__/../lynx/cgi/My:__PATH__/../lynx/cgi
@ scripts/home/frew/code/ziprecruiter/bash_enter
 autostash PATH=__PATH__/bin:$PATH
 autostash WWW=www.ziprecruiter-frew.com
 autostash DB=db.ziprecruiter-frew.com
 autostash LOCAL_SANDBOX_MOUNT_TYPE=vboxsf
 autostash dkrdb dkrwww
 
 _exec() docker exec -it --user $(whoami) "$@"
 execwww() _exec $WWW "$@"
 execdb() _exec $DB "$@"
 dkrdb() execdb bash -l
 dkrwww() execwww bash -l
 runtests() execwww env SKIP_SLOW_TESTS=1 prove /var/starterview/bin/zr-run-tests :: --no-volatile
 run_s() execwww env TERM=linux bash -c 'cd /var/starterview; export PATH=$PATH:/var/starterview/bin; "$@"' _ "$@"
 with_x() run_s perl -MStarterView::Bootstrap -Maliased=$1,X -E $2
 
 _fix_for_foo() run_s sudo chown -R $1 $(run_s perl -e'print join q( ), glob(q(/tmp/TT*_cache-0))') /var/starterview/app/view/static/assembled
 fix-for-apache() _fix_for_foo apache
 fix-for-frew()   _fix_for_foo frew
@ scripts/home/frew/Dropbox/money/bash_enter
 autostash PATH=__PATH__/bin:$PATH
@ scripts/home/frew/code/lynx/root/bash_enter
 autostash DBIC_TRACE=
 autostash BUSHIDO=1
 autostash WM_DEBUG=1
 autostash CATALYST_DEBUG=1
 autostash LYNX_DSN_PATH=/home/frew/code/flu-db.txt
 autostash PERL5LIB=__PATH__/App/lib:__PATH__/cgi/My:__PATH__/cgi
 autostash alias grl='gr linux-support'
 autostash alias grc='git rebase --continue'
 autostash alias grC='git commit --amend -a -C HEAD && git rebase --continue'
 autostash alias gds='git diff --staged'
 autostash alias gra='git rebase --abort'
 autostash LIVE_TEST_SERVER=localhost:5000
 
 autostash lynxapp lynxservice brr loc cobr kr
 
 function pgup() {
    docker run --rm -p 5432:5432 -P --name pg_lynx postgres:9.3 2>&1 > /dev/null &
 }
 
 function pgdown() {
    docker stop pg_lynx
 }
 
 function pgon() {
    LYNX_DSN_PATH=/home/frew/code/flu-pg-db.txt
 }
 
 function lynxapp() {
    # start a subshell here to set ulimit
    plackup -R App/lib,cgi/My
 }
 
 function lynxservice() {
    # start a subshell here to set ulimit
    (cd cgi; perl Lynx_service.plx)
 }
 
 function brr() {
    git branch -r | grep -i /$1- | perl -plaE'$_ = $F[0]'
 }
 
 function loc() {
    echo $1 | cut -d'/' -f2-
 }
 
 function cobr() {
    local remote="$(brr $1)"
    git checkout -b "$(loc $remote)" $remote
 }
 
 function kr() {
    gitk "$(brr $1)"
 }
 
 function win32-logging() {
    perl -MLynx::Util -E'
       my $config_rs = Lynx::Util::dbic_connect->resultset("Config");
       sub sv {
          my ($k, $v) = @_;
          $config_rs->set_value($k, "X:/$v" )
       }
       sv(LOG       => "log");
       sv(Datastore => "Sound");
       sv(Mapstore  => "maps");
       sv(BackupDIR => "Backup");
    '
 }
 
 function linux-logging() {
    mkdir -p ~/code/lynx-{sound,maps,backups,logs}
    perl -MLynx::Util -E'
       my $config_rs = Lynx::Util::dbic_connect->resultset("Config");
       sub sv {
          my ($k, $v) = @_;
          $config_rs->set_value($k, "/home/frew/code/lynx-$v" )
       }
       sv(LOG       => "logs");
       sv(Datastore => "sound");
       sv(Mapstore  => "maps");
       sv(BackupDIR => "backups");
    '
 }
 
 function devel-init() {
    echo '["**/*","**/.*"]' > __PATH__/negaglobs.json
    echo '{}' > __PATH__/tree.json
 }
 
 function _tailer() {
    tmux new-window -n $1 "dash -c 'tail -F ~/log/lxs/$2/current | tai64nlocal'"
 }
 
 function tail-web() {
    _tailer web web
 }
 
 function tail-msg() {
    _tailer msg 'msg*'
 }
 
 function tail-pure-async() {
    _tailer pure-async pure-async
 }
 
 function tail-async() {
    _tailer async async
 }
 
 function tail-imap() {
    _tailer imap imap
 }
 
 function tail-minotaur() {
    _tailer minotaur minotaur
 }
 
 function tail-all() {
    tail-web
    tail-msg
    tail-pure-async
    tail-async
    tail-imap
    tail-minotaur
 }
 
 function _all() {
    for x in lxs-async lxs-imap lxs-message-service-1 lxs-message-service-2 lxs-message-service-3 lxs-minotaur lxs-pure-async lxs-web; do
       sv $1 $x
    done
 }
 
 function startall() {
    _all up
 }
 
 function stopall() {
    _all down
 }
 
 function restartall() {
    _all restart
 }
